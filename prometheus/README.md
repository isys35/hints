<h1>Prometheus</h1>

<h3>Способы передачи</h3>
    <ul>
        <li><b>Pull</b> - Prometheus запрашивает метрики у целевого объекта через Pull-запрос, настройки которого прописаны в файле конфигурации в секции scrape_config для каждого из заданий (job). </li>
        <li><b>Exporters</b> - Exporters позволят собирать метрики с различных объектов, например: базы данных (MongoDB, SQL и т.д.), брокеры сообщений (RabbitMQ, EMQ, NSQ и т.д.), балансировщики нагрузки HTTP и т.д.</li>
        <li><b>Pushgateway</b> - Может быть использован в случае необходимости, когда приложение не может предоставить возможность напрямую отдавать метрики в Prometheus; либо когда используются пакетные задания, которые не имеют возможности использовать Pull-запрос Prometheus. </li>
    </ul>


<h3>Типы данных</h3>
    <ul>
        <li><b>Counter</b> - считает количество за некоторый промежуток времени. Данный тип метрик может только увеличиваться (нельзя использовать отрицательные значения) или обнулять значение.
Может подходить, например, для подсчёта количества запросов в минуту или количество ошибок за день, количество отправленных/принятых сетевых пакетов и т.д.</li>
        <li><b>Gauge</b> - хранит значения, которые со временем могут уменьшаться или увеличиваться.
Gauge не показывает развитие метрики за период времени. Используя Gauge, можно потерять нерегулярные изменения метрики со временем.</li>
        <li><b>Histogram</b> - сохраняет несколько временных рядов: общая сумма всех наблюдаемых величин; количество событий, которые наблюдались; накопительные счетчики (buckets) — указываются в метке как le="<upper inclusive bound>".
Значения собираются в области с настраиваемой верхней границей (buckets). </li>
        <li><b>Summary</b> - сохраняет несколько временных рядов: общая сумма всех наблюдаемых величин; количество событий, которые наблюдались; потоковые φ-квантили (0 ≤ φ ≤ 1) наблюдаемых событий — указываются в метке как quantile="<φ>"</li>
    </ul>


<h3>Формат данных для Prometheus</h3>


```<metric name>{<label name>=<label value>, ...}```

```api_http_requests_total{method="POST", handler="/messages"}```


<h3>Запуск в докере</h3>

```shell
docker run -p 9090:9090 prom/prometheus
```


```shell
docker run -p 9090:9090 -v <path to prometheus.yml>:/etc/prometheus/prometheus.yml prom/prometheus
```

```shell
docker run -p 9090:9090 -v <path to config>:/etc/prometheus prom/prometheus
```